<!DOCTYPE html>
<html lang="en-us">
<head>
  <title>Emacs: 神器 Org-mode - 你对这个世界要有点意见</title>
  <meta charset="utf-8" />
  <meta name="author" content="lijigang" />


  <link rel="alternate" title="RSS Feed" href="/rss.xml" type="application/rss+xml">
  <link rel="stylesheet" href="/media/css/main.css" type="text/css">
  <link rel="stylesheet" href="/media/css/posts.css" type="text/css">
</head>

  <body class="container">
<header id="header">
<body>
    <nav class="navbar navbar-default navbar-fixed-top" style="opacity: .9" role="navigation">
        <div class="container-fluid">
<div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">你对这个世界要有点意见</a>
        </div>
<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li class="active"><a href="/">Blog</a></li>
          <li><a href="https://github.com/lijigang">GitHub</a></li>
          <li><a href="http://www.zhihu.com/people/lijigang.com">知乎</a></li>
        </ul>
</div>
</div>
    </nav>
</body>
</header>

<section id="content" role="main">
    <div id="outline-container-sec-" class="row post-content">
        <div class="col-md-2"></div>
            <h1>Emacs: 神器 Org-mode</h1>
            <blockquote>
<p>
Org is a mode for keeping notes, maintaining TODO lists, and project planning
with a fast and effective plain-text system.
</p>

<p>
It also is an authoring system with unique support for literate programming and
reproducible research.
</p>
</blockquote>

<p>
Org mode 称为神器一点都不为过，如果你平时工作内容有和文字处理相关的，绝对值得花一个月时间好好学习下 Emacs 中的 Orgmode。
</p>

<p>
关于 Org mode 在各方面使用的总结, 有很多优秀文章: <a href="https://emacs.cafe/emacs/orgmode/gtd/2017/06/30/orgmode-gtd.html">GTD</a> , <a href="http://cachestocaches.com/2018/6/org-literate-programming/">Literate Programming</a> ,
<a href="http://ehneilsen.net/notebook/orgExamples/org-examples.html">Cookbook</a> , 当然也少不了经典的 <a href="http://doc.norang.ca/org-mode.html">Organize Your Life In Plain Text!</a> .
</p>

<p>
本文旨在将平时收集使用的 snippets 汇总成 orgmode handbook， 方便同道中人随时取用。
</p>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org0c861d0">Beautify</a>
<ul>
<li><a href="#orgb5a5b8f">如何隐藏 headlines 前面的一堆*符号？</a></li>
<li><a href="#org6a25c84">如何将 headlines 的符号从*变成其它符号？</a></li>
<li><a href="#orged00077">如何直接显示 <b>加粗</b> 、 <del>删除线</del> 、 <code>强调</code> 等样式？</a></li>
<li><a href="#orgf891eb5">如何设置 headline 的 TODO keywords？</a></li>
<li><a href="#org90989bc">如何给 TODO keywords 增加前景色、背景色？</a></li>
</ul>
</li>
<li><a href="#org4248b0a">Capture-Refile-Archive</a>
<ul>
<li><a href="#orgad4a7b3">如何快速记录一些内容到指定文件？</a></li>
<li><a href="#org43bec29">如何设置不同的快速记录模板？</a></li>
<li><a href="#org79a2dc4">如何快速移动 headline 到指定文件中？</a></li>
<li><a href="#orgeaf8e30">如何归档已完成事项到其它文件？</a></li>
</ul>
</li>
<li><a href="#orgdd6ee99">Tables</a>
<ul>
<li><a href="#org8580d2d">如何像 Excel 一样，在表格中插入 <code>mini graph</code> ？</a></li>
</ul>
</li>
<li><a href="#org1d1c63a">Agendas</a>
<ul>
<li><a href="#org9d1629c">如何将 Agenda 中不同时间长度的事项显示不同的大小？</a></li>
<li><a href="#orgd69f17f">如何设置 agenda 中时间的显示格式？</a></li>
<li><a href="#orgbdc3471">如何隐藏 agenda 中的分隔线？</a></li>
<li><a href="#orgd70dac9">如何在 agenda 中显示本地的日出日落时间？</a></li>
</ul>
</li>
<li><a href="#org55c8a34">Others</a>
<ul>
<li><a href="#org55cdf45">如何用 org 文件管理 RSS 订阅？</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org0c861d0" class="outline-2">
<h2 id="org0c861d0">Beautify</h2>
<div class="outline-text-2" id="text-org0c861d0">
</div>
<div id="outline-container-orgb5a5b8f" class="outline-3">
<h3 id="orgb5a5b8f">如何隐藏 headlines 前面的一堆*符号？</h3>
<div class="outline-text-3" id="text-orgb5a5b8f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq org-startup-indented t)
</pre>
</div>
</div>
</div>
<div id="outline-container-org6a25c84" class="outline-3">
<h3 id="org6a25c84">如何将 headlines 的符号从*变成其它符号？</h3>
<div class="outline-text-3" id="text-org6a25c84">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq org-bullets-bullet-list '("☰" "☷" "☯" "☭"))
</pre>
</div>
</div>
</div>
<div id="outline-container-orged00077" class="outline-3">
<h3 id="orged00077">如何直接显示 <b>加粗</b> 、 <del>删除线</del> 、 <code>强调</code> 等样式？</h3>
<div class="outline-text-3" id="text-orged00077">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq org-hide-emphasis-markers t)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf891eb5" class="outline-3">
<h3 id="orgf891eb5">如何设置 headline 的 TODO keywords？</h3>
<div class="outline-text-3" id="text-orgf891eb5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; "|"之前的为进行中的状态， 之后的为结束的状态
(setq org-todo-keywords
      '((sequence "TODO" "HAND" "|" "DONE")))
</pre>
</div>
</div>
</div>
<div id="outline-container-org90989bc" class="outline-3">
<h3 id="org90989bc">如何给 TODO keywords 增加前景色、背景色？</h3>
<div class="outline-text-3" id="text-org90989bc">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setf org-todo-keyword-faces '(("TODO" . (:foreground "white" :background "#95A5A6"   :weight bold))
                                ("HAND" . (:foreground "white" :background "#2E8B57"  :weight bold))
                                ("DONE" . (:foreground "white" :background "#3498DB" :weight bold))))
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org4248b0a" class="outline-2">
<h2 id="org4248b0a">Capture-Refile-Archive</h2>
<div class="outline-text-2" id="text-org4248b0a">
</div>
<div id="outline-container-orgad4a7b3" class="outline-3">
<h3 id="orgad4a7b3">如何快速记录一些内容到指定文件？</h3>
<div class="outline-text-3" id="text-orgad4a7b3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; 设置默认保存到哪个文件中
(setq org-default-notes-file "path/to/your/notes")

;; 设置快捷键来调用 org-capture
(global-set-key (kbd "C-c c") 'org-capture)
</pre>
</div>
</div>
</div>
<div id="outline-container-org43bec29" class="outline-3">
<h3 id="org43bec29">如何设置不同的快速记录模板？</h3>
<div class="outline-text-3" id="text-org43bec29">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq org-capture-templates
              '(("p"  ;;快捷键
                 "Personal" ;; 描述
                 entry ;; 填充类型为 heading
                 (file+headline org-default-notes-file  "Personal")
                 "** TODO %?\n  %i\n")
                ;; %?: 填完后光标所在位置
                ;; %U: 非活跃的时间戳
                ;; %i: 初始内容. 如果有选中区域, 即为该区域内容
                ;; %a: 注释. 通常为 org-store-link 创建的链接

                ("m"
                 "Meeting"
                 entry
                 (file+headline "path/to/your/meeting/file" "Meetings")
                 "** TODO %?\n  %i\n")

                ("w"
                 "Work"
                 entry
                 (file+headline org-default-notes-file "Work")
                 "** TODO %?\n  %i\n")
                  ))
</pre>
</div>
</div>
</div>
<div id="outline-container-org79a2dc4" class="outline-3">
<h3 id="org79a2dc4">如何快速移动 headline 到指定文件中？</h3>
<div class="outline-text-3" id="text-org79a2dc4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; 设置移动到的目标文件列表为 agenda-files
(setq org-refile-targets '((org-agenda-files :maxlevel . 3)))
</pre>
</div>

<p>
More info: <a href="https://blog.aaronbieber.com/2017/03/19/organizing-notes-with-refile.html">Aaron Bieber's article</a>
</p>
</div>
</div>
<div id="outline-container-orgeaf8e30" class="outline-3">
<h3 id="orgeaf8e30">如何归档已完成事项到其它文件？</h3>
<div class="outline-text-3" id="text-orgeaf8e30">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; this is the default: current file is a.org, archive in file a.org_archive
(setq org-archive-location "%s_archive")
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">
<caption class="t-above"><span class="table-number">Table 1:</span> org-archive-location options</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">location value</th>
<th scope="col" class="org-left">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">"::*Archived Tasks"</td>
<td class="org-left">Archive in the current file</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">under the top level headline</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">*Archived Tasks</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">"~/org/archive.org"</td>
<td class="org-left">Archive in file ~/org/archive.org</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">as top level trees</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">"~/org/archive.org::datetree/"</td>
<td class="org-left">datetree is special. the heading will</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">be a subentry to the current date.</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">(there always need to be a "/"</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">after datetree)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-orgdd6ee99" class="outline-2">
<h2 id="orgdd6ee99">Tables</h2>
<div class="outline-text-2" id="text-orgdd6ee99">
</div>
<div id="outline-container-org8580d2d" class="outline-3">
<h3 id="org8580d2d">如何像 Excel 一样，在表格中插入 <code>mini graph</code> ？</h3>
<div class="outline-text-3" id="text-org8580d2d">
<pre class="example">
;; while the cursor is on a column,
;; this command will create a new column
;; containing an ascii-art bars plot.

M-x: orgtble-ascii-plot

;; this command insert a formula:
;; (orgtbl-ascii-draw COLUMN MIN MAX WIDTH)
</pre>

<table border="2" cellspacing="0" cellpadding="6" rules="all" frame="border">
<caption class="t-above"><span class="table-number">Table 2:</span> insert ascii chart into table</caption>

<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-right">date</td>
<td class="org-right">money</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-right">20100101</td>
<td class="org-right">9.92</td>
<td class="org-left">WWWWWWWWWH</td>
</tr>

<tr>
<td class="org-right">20100201</td>
<td class="org-right">4.52</td>
<td class="org-left">WWWW!</td>
</tr>

<tr>
<td class="org-right">20210301</td>
<td class="org-right">15.99</td>
<td class="org-left">WWWWWWWWWWWWWWWW</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div id="outline-container-org1d1c63a" class="outline-2">
<h2 id="org1d1c63a">Agendas</h2>
<div class="outline-text-2" id="text-org1d1c63a">
</div>
<div id="outline-container-org9d1629c" class="outline-3">
<h3 id="org9d1629c">如何将 Agenda 中不同时间长度的事项显示不同的大小？</h3>
<div class="outline-text-3" id="text-org9d1629c">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; agenda 里面时间块彩色显示
;; From: https://emacs-china.org/t/org-agenda/8679/3
(defun ljg/org-agenda-time-grid-spacing ()
  "Set different line spacing w.r.t. time duration."
  (save-excursion
    (let* ((background (alist-get 'background-mode (frame-parameters)))
           (background-dark-p (string= background "dark"))
           (colors (list "#1ABC9C" "#2ECC71" "#3498DB" "#9966ff"))
           pos
           duration)
      (nconc colors colors)
      (goto-char (point-min))
      (while (setq pos (next-single-property-change (point) 'duration))
        (goto-char pos)
        (when (and (not (equal pos (point-at-eol)))
                   (setq duration (org-get-at-bol 'duration)))
          (let ((line-height (if (&lt; duration 30) 1.0 (+ 0.5 (/ duration 60))))
                (ov (make-overlay (point-at-bol) (1+ (point-at-eol)))))
            (overlay-put ov 'face `(:background ,(car colors)
                                                :foreground
                                                ,(if background-dark-p "black" "white")))
            (setq colors (cdr colors))
            (overlay-put ov 'line-height line-height)
            (overlay-put ov 'line-spacing (1- line-height))))))))

(add-hook 'org-agenda-finalize-hook #'ljg/org-agenda-time-grid-spacing)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd69f17f" class="outline-3">
<h3 id="orgd69f17f">如何设置 agenda 中时间的显示格式？</h3>
<div class="outline-text-3" id="text-orgd69f17f">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; if set it to t, 9:30am would become 09:30.
(setq org-agenda-time-leading-zero t)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbdc3471" class="outline-3">
<h3 id="orgbdc3471">如何隐藏 agenda 中的分隔线？</h3>
<div class="outline-text-3" id="text-orgbdc3471">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq org-agenda-use-time-grid nil)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd70dac9" class="outline-3">
<h3 id="orgd70dac9">如何在 agenda 中显示本地的日出日落时间？</h3>
<div class="outline-text-3" id="text-orgd70dac9">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; learn from https://github.com/AbstProcDo/Master-Emacs-From-Scrach-with-Solid-Procedures/blob/master/05.Emacs-as-a-Agenda-by-Org.org

(setq org-agenda-include-diary t)
(setq org-agenda-diary-file "your/path/to/standard-diary")
(setq diary-file "your/path/to/standard-diary")

;; 设置本地经纬度坐标
(setq calendar-latitude 39.9042)
(setq calendar-longitude 116.4074)

;;Sunrise and Sunset
;;日出而作, 日落而息
(defun diary-sunrise ()
  (let ((dss (diary-sunrise-sunset)))
    (with-temp-buffer
      (insert dss)
      (goto-char (point-min))
      (while (re-search-forward " ([^)]*)" nil t)
        (replace-match "" nil nil))
      (goto-char (point-min))
      (search-forward ",")
      (buffer-substring (point-min) (match-beginning 0)))))

(defun diary-sunset ()
  (let ((dss (diary-sunrise-sunset))
        start end)
    (with-temp-buffer
      (insert dss)
      (goto-char (point-min))
      (while (re-search-forward " ([^)]*)" nil t)
        (replace-match "" nil nil))
      (goto-char (point-min))
      (search-forward ", ")
      (setq start (match-end 0))
      (search-forward " at")
      (setq end (match-beginning 0))
      (goto-char start)
      (capitalize-word 1)
      (buffer-substring start end))))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; content of file standard-diary

;;Day info
;; 日出而作, 日落而息
%%(diary-sunrise)
%%(diary-sunset)
</pre>
</div>

<p>
设置后的效果如下：
</p>
<pre class="example">
Day-agenda (W17):
Tuesday    21 April 2020
05:29......  Sunrise
12:00-13:00 Scheduled:  DONE 和 @XX 吃饭 1on1
18:58......  Sunset
</pre>
</div>
</div>
</div>
<div id="outline-container-org55c8a34" class="outline-2">
<h2 id="org55c8a34">Others</h2>
<div class="outline-text-2" id="text-org55c8a34">
</div>
<div id="outline-container-org55cdf45" class="outline-3">
<h3 id="org55cdf45">如何用 org 文件管理 RSS 订阅？</h3>
<div class="outline-text-3" id="text-org55cdf45">
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; use an org file to organise feeds
(use-package elfeed-org
  :ensure t
  :config
  (elfeed-org)
  (setq rmh-elfeed-org-files (list "/path/to/elfeed.org")))
</pre>
</div>

<p>
More info: <a href="http://pragmaticemacs.com/emacs/read-your-rss-feeds-in-emacs-with-elfeed/">Pragmatic emacs's article</a>
</p>
</div>
</div>
</div>

    </div>
</section>




<footer id="footer">
    <br />
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?36d44a2295ffa55a3ab51c6aa7a71733";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
</footer>

  </body>
</html>
