#+TITLE: Emacs: 神器 Org-mode
#+DATE: <2018-08-08 Wed>
#+options: toc:nil num:nil

#+BEGIN_QUOTE
Org is a mode for keeping notes, maintaining TODO lists, and project planning
with a fast and effective plain-text system.

It also is an authoring system with unique support for literate programming and
reproducible research.
#+END_QUOTE

Org mode 官网上介绍的这段文字基本描述清了它可实现的功能, 但用词还是腼腆了点, 它
就是效率之神. 如果你喜欢管理记录, 喜欢 GTD, 一定一定要学习下 =Org mode= , 学会它,
你会放弃你所知道的一切其它的效率软件.

关于 Org mode 在各方面使用的总结, 有很多优秀文章: [[https://emacs.cafe/emacs/orgmode/gtd/2017/06/30/orgmode-gtd.html][GTD]] , [[http://cachestocaches.com/2018/6/org-literate-programming/][Literate Programming]] ,
[[http://ehneilsen.net/notebook/orgExamples/org-examples.html][Cookbook]] , 当然也少不了最最经典的 [[http://doc.norang.ca/org-mode.html][Organize Your Life In Plain Text!]] .

Emacs 本质上就是强调使用纯文本, Org mode 是其中一个 mode, 把纯文本应用到炉火纯青的地步了. 大部分人, 不需要使用 Emacs 写代码, 但日常效率管理或者文档记录的需求, 完全可以通过 Org mode 满足.

#+TOC: headlines 2

* Beautify
** DONE 如何隐藏 headlines 前面的一堆*符号？
#+begin_src emacs-lisp
(setq org-startup-indented t)
#+end_src
** DONE 如何将 headlines 的符号从*变成其它符号？

#+begin_src emacs-lisp
(setq org-bullets-bullet-list '("☰" "☷" "☯" "☭"))
#+end_src
** DONE 如何直接显示 *加粗* 、 +删除线+ 、 _下划线_ 样式？

  #+begin_src emacs-lisp
  (setq org-hide-emphasis-markers t)
  #+end_src
** DONE 如何设置 headline 的 TODO keywords？

#+begin_src emacs-lisp
;; "|"之前的为进行中的状态， 之后的为结束的状态
(setq org-todo-keywords
      '((sequence "TODO" "HAND" "|" "DONE")))
#+end_src
** DONE 如何给 TODO keywords 增加前景色、背景色？

#+begin_src emacs-lisp
(setf org-todo-keyword-faces '(("TODO" . (:foreground "white" :background "#95A5A6"   :weight bold))
                                ("HAND" . (:foreground "white" :background "#2E8B57"  :weight bold))
                                ("DONE" . (:foreground "white" :background "#3498DB" :weight bold))))
#+end_src
** DONE 如何将 Agenda 中不同时间长度的事项显示不同的大小？

#+begin_src emacs-lisp
;; agenda 里面时间块彩色显示
;; From: https://emacs-china.org/t/org-agenda/8679/3
(defun ljg/org-agenda-time-grid-spacing ()
  "Set different line spacing w.r.t. time duration."
  (save-excursion
    (let* ((background (alist-get 'background-mode (frame-parameters)))
           (background-dark-p (string= background "dark"))
           (colors (list "#1ABC9C" "#2ECC71" "#3498DB" "#9966ff"))
           pos
           duration)
      (nconc colors colors)
      (goto-char (point-min))
      (while (setq pos (next-single-property-change (point) 'duration))
        (goto-char pos)
        (when (and (not (equal pos (point-at-eol)))
                   (setq duration (org-get-at-bol 'duration)))
          (let ((line-height (if (< duration 30) 1.0 (+ 0.5 (/ duration 60))))
                (ov (make-overlay (point-at-bol) (1+ (point-at-eol)))))
            (overlay-put ov 'face `(:background ,(car colors)
                                                :foreground
                                                ,(if background-dark-p "black" "white")))
            (setq colors (cdr colors))
            (overlay-put ov 'line-height line-height)
            (overlay-put ov 'line-spacing (1- line-height))))))))

(add-hook 'org-agenda-finalize-hook #'ljg/org-agenda-time-grid-spacing)
#+end_src

* Capture-Refile-Archive
** DONE 如何快速记录一些内容到指定文件？

#+begin_src emacs-lisp
;; 设置默认保存到哪个文件中
(setq org-default-notes-file "path/to/your/notes")

;; 设置快捷键来调用 org-capture
(global-set-key (kbd "C-c c") 'org-capture)
#+end_src
** DONE 如何设置不同的快速记录模板？
#+begin_src emacs-lisp
(setq org-capture-templates
              '(("p"  ;;快捷键
                 "Personal" ;; 描述
                 entry ;; 填充类型为 heading
                 (file+headline org-default-notes-file  "Personal")
                 "** TODO %?\n  %i\n")
                ;; %?: 填完后光标所在位置
                ;; %U: 非活跃的时间戳
                ;; %i: 初始内容. 如果有选中区域, 即为该区域内容
                ;; %a: 注释. 通常为 org-store-link 创建的链接

                ("m"
                 "Meeting"
                 entry
                 (file+headline "path/to/your/meeting/file" "Meetings")
                 "** TODO %?\n  %i\n")

                ("w"
                 "Work"
                 entry
                 (file+headline org-default-notes-file "Work")
                 "** TODO %?\n  %i\n")
                  ))
#+end_src
** DONE 如何快速移动 headline 到指定文件中？
#+begin_src emacs-lisp
;; 设置移动到的目标文件列表为 agenda-files
(setq org-refile-targets '((org-agenda-files :maxlevel . 3)))
#+end_src

More info: [[https://blog.aaronbieber.com/2017/03/19/organizing-notes-with-refile.html][Aaron Bieber's article]]
** DONE 如何归档已完成事项到其它文件？
#+begin_src emacs-lisp
;; this is the default: current file is a.org, archive in file a.org_archive
(setq org-archive-location "%s_archive")
#+end_src

#+caption: org-archive-location options
| location value                 | meaning                               |
|--------------------------------+---------------------------------------|
| "::*Archived Tasks"            | Archive in the current file           |
|                                | under the top level headline          |
|                                | *Archived Tasks                       |
|--------------------------------+---------------------------------------|
| "~/org/archive.org"            | Archive in file ~/org/archive.org     |
|                                | as top level trees                    |
|--------------------------------+---------------------------------------|
| "~/org/archive.org::datetree/" | datetree is special. the heading will |
|                                | be a subentry to the current date.    |
|                                | (there always need to be a "/"        |
|                                | after datetree)                       |
|--------------------------------+---------------------------------------|
* Tables
* Agendas
* Others
** TODO 如何用 org 文件管理 RSS 订阅？
